#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —É–∑–±–µ–∫—Å–∫–∏–π –≤ CafeBot –ø—Ä–æ–µ–∫—Ç–µ

echo "üöÄ –ù–∞—á–∏–Ω–∞–µ–º –ø–µ—Ä–µ–≤–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —É–∑–±–µ–∫—Å–∫–∏–π —è–∑—ã–∫..."

# –ú–∞—Å—Å–∏–≤ –ø–µ—Ä–µ–≤–æ–¥–æ–≤: "—Ä—É—Å—Å–∫–∏–π"="—É–∑–±–µ–∫—Å–∫–∏–π"
declare -A translations=(
    # –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—Ä–∞–∑—ã
    ["–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑"]="Buyurtma yaratish"
    ["–ú–æ–∏ –∑–∞–∫–∞–∑—ã"]="Mening buyurtmalarim"
    ["–ö–æ–º–Ω–∞—Ç—ã"]="Xonalar"
    ["–ü–æ–º–æ—â—å"]="Yordam"
    ["–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å"]="Admin paneli"
    ["–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ"]="Harakatni tanlang"
    ["–í—ã –≤–æ—à–ª–∏ –∫–∞–∫"]="Siz sifatida kirdingiz"
    ["–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä"]="admin"
    ["–æ—Ñ–∏—Ü–∏–∞–Ω—Ç"]="ofitsiant"
    ["–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å"]="Xush kelibsiz"

    # –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
    ["–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞"]="Xatolik yuz berdi"
    ["–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑"]="Qaytadan urinib ko'ring"
    ["–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç"]="Noto'g'ri format"
    ["–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞"]="Sizda kirish huquqi yo'q"
    ["–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É"]="Administrator bilan bog'laning"

    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
    ["–ù–∞–∑–≤–∞–Ω–∏–µ"]="Nomi"
    ["–¶–µ–Ω–∞"]="Narx"
    ["–û–ø–∏—Å–∞–Ω–∏–µ"]="Tavsif"
    ["–ö–∞—Ç–µ–≥–æ—Ä–∏—è"]="Kategoriya"
    ["–î–æ—Å—Ç—É–ø–Ω–æ"]="Mavjud"
    ["–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ"]="Mavjud emas"

    # –î–µ–π—Å—Ç–≤–∏—è
    ["–î–æ–±–∞–≤–∏—Ç—å"]="Qo'shish"
    ["–ò–∑–º–µ–Ω–∏—Ç—å"]="O'zgartirish"
    ["–£–¥–∞–ª–∏—Ç—å"]="O'chirish"
    ["–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"]="Saqlash"
    ["–û—Ç–º–µ–Ω–∞"]="Bekor qilish"
)

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–º–µ–Ω—ã –≤ —Ñ–∞–π–ª–µ
replace_in_file() {
    local file="$1"
    local temp_file="${file}.tmp"

    cp "$file" "$temp_file"

    for ru_text in "${!translations[@]}"; do
        uz_text="${translations[$ru_text]}"
        sed -i "s|$ru_text|$uz_text|g" "$temp_file"
    done

    if ! cmp -s "$file" "$temp_file"; then
        mv "$temp_file" "$file"
        echo "‚úÖ –ü–µ—Ä–µ–≤–µ–¥–µ–Ω: $file"
    else
        rm "$temp_file"
    fi
}

# –ù–∞–π—Ç–∏ –≤—Å–µ C# —Ñ–∞–π–ª—ã —Å —Ä—É—Å—Å–∫–∏–º —Ç–µ–∫—Å—Ç–æ–º
echo "üîç –ò—â–µ–º —Ñ–∞–π–ª—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞..."
files=$(find . -name "*.cs" -exec grep -l "[–ê-–Ø–∞-—è]" {} \;)

echo "üìù –ù–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: $(echo "$files" | wc -l)"

# –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –∫–∞–∂–¥—ã–π —Ñ–∞–π–ª
for file in $files; do
    replace_in_file "$file"
done

echo "üéâ –ü–µ—Ä–µ–≤–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω!"
echo "üìã –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
